/**
 * This function runs when it receives data from an external app, like your Python script.
 * e.postData.contents contains the data sent from the app.
 */
function doPost(e) {
  try {
    // 1. Get the questions and options sent from your Python app
    var mcqData = JSON.parse(e.postData.contents);
    
    // 2. Create a new Google Form with a title
    var form = FormApp.create('Auto-Generated MCQ Form');
    form.setDescription('These questions were generated by the Python MCQ application.');
    
    // 3. Loop through each question and add it to the form
    for (var i = 0; i < mcqData.length; i++) {
      var questionText = mcqData[i][0]; // The question string
      var choicesArray = mcqData[i][1]; // The array of options
      
      // Add a multiple-choice item to the form
      var mcqItem = form.addMultipleChoiceItem();
      
      // Set the question's title and its answer choices
      mcqItem.setTitle(questionText);
      mcqItem.setChoiceValues(choicesArray);
    }
    
    // 4. Return the public URL of the newly created form back to your Python app
    return ContentService.createTextOutput(form.getPublishedUrl());
    
  } catch (error) {
    // If anything goes wrong, return a clear error message
    return ContentService.createTextOutput('Error in Google Apps Script: ' + error.toString());
  }
}
